<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
	<!--no-js 检测当前浏览器是否支持css3、h5 并且使浏览器支持h5新标签。。-->

	<head>
		<meta charset="utf-8" />
		<title>河南工业大学IT教育</title>
	</head>
	<!--自定义css文件-->
	<link rel="stylesheet" href="css/hj_css.css" type="text/css" />
	<link rel="stylesheet" href="css/element-ui.css" />
	<!--模板首页工共js、css文件引用-->
	<script src="js/commonCss.js"></script>
	<script src="js/commonJs.js"></script>

	<script src="js/vue.min.js"></script>
	<script src="js/axios.min.js"></script>
	<script src="js/element-ui.js"></script>

	<body id="body" class="wide-layout preloader-active">
		<noscript>
        <div class="noscript alert-error">
			要实现本站点的全部功能，必须启用JavaScript。这里是<a href="http://www.enable-javascript.com/" target="_blank">如何在web浏览器中启用JavaScript的说明</a>
        </div>
    </noscript>

		<!-- 预加载器-->
		<div id="preloader" class="preloader">
			<div class="loader-cube">
				<div class="loader-cube__item1 loader-cube__item"></div>
				<div class="loader-cube__item2 loader-cube__item"></div>
				<div class="loader-cube__item4 loader-cube__item"></div>
				<div class="loader-cube__item3 loader-cube__item"></div>
			</div>
		</div>
		<!-- 预加载器结束 -->

		<!--包装器-->
			<div class="header-menu bg-blue " id="topMenu" style="line-height:0">//calss里的topPosition 属性和style是用于固定顶部的 不需要固定可以删除
					<div class="container">
						<div class="row">
							<div class="container">
								<nav class="nav-bar">
									<div class="nav-header">
										<span class="nav-toggle" data-toggle="#header-navbar">
			                        		<i></i>
			                        		<i></i>
			                        		<i></i>
			                    		</span>
									</div>
									<div id="header-navbar" class="nav-collapse">
										<ul class="nav-menu">
											<li>
												<span>
												<a href="index.html" class="logo" style="margin-left: -10px;">
													<img src="http://localhost:8010/LOGOysd.png" alt="" width="120px" style="height: 50px" >
												</a>
											</span>
											</li>
											<li class="dropdown-mega-menu">
												<a>课程</a>
												<div class="mega-menu" style="width: 39%;">
													<ul style="overflow: hidden; width: 100%;">
														<li v-for="(a,index) in category" v-if="index<6" style="width: 200px; float: left;">
															<a href="#"><img src="http://localhost:8010/img/apple-touch-icon.png" class="manuImg" />{{a.navName}}</a>
														</li>
														<li v-else style="width:200px; float: left;">
															<a href="#"><img src="http://localhost:8010/img/apple-touch-icon.png" class="manuImg" />{{a.navName}}</a>
														</li>
													</ul>
												</div>
											</li>
											<li>
												<a href="coupons_grid.html">2019考研</a>
											</li>
											<li>
												<a href="stores_01.html">学校云</a>
											</li>
											<li>
												<a href="contact_us_01.html">名师专栏</a>
											</li>
											<li style=" margin-left: 100px;">
												<input type="text" class="form-control input-lg search-input"  style=" border: none; margin-top:9px; background-color: white; height: 39px; width: 230px;" placeholder="搜索感兴趣的课程" required="required" v-model='inputText' @keyup='show($event)' @keydown.down='down()' @keydown.up.prevent='up()'>
												<ul style="width: 100%; position: absolute; z-index: 11; background-color: white">
													<li  v-for="(item, index) in result" v-if="index<10" :class='{bg: index==nowIndex}' >
												        <a href="#" ><div class="searchSelect">{{item.lrId}}</div></a>
												    </li>
												</ul>
											</li>
											<li>
												<el-button type="success" style=" margin-top: 9px;" icon="el-icon-search"></el-button>
											</li>
											<li id="topUser" style="margin-top: 8px; width: 100px; height: 10px; ">
												<div id="myCenter1" style="width: 100%;" v-if="Hwg.getToken()!=''&&Hwg.getToken()!=null&&Hwg.getToken()!='null'" >
													<el-menu class="el-menu-demo" mode="horizontal" style="border-bottom: none;" active-text-color="#fff">
														<el-submenu index="2">
															<template slot="title" >
																<a href="myCenter.html" style="color: white;">个人中心</a>
															</template>
															<div style="width: 20%; margin: 5px auto;">
																<img src="http://localhost:8010/MSLOGO.png" class="myImage" style="border:  solid 1px rosybrown;">
															</div>
															<div style="margin: 0 auto; text-align: center; font-size: 20px;">{{user.ui_truename}}</div>
															<el-menu-item >
																<div class="myCourse" style="text-align: center;"><a>计算机</a></div>
															</el-menu-item>
															<el-menu-item>
																<div class="myCourse"  style="text-align: center;"><a>大数据分析</a></div>
															</el-menu-item>
															<el-menu-item>
																<div class="myCourse"  style="text-align: center;"><a>面向对象编程Java</a></div>
															</el-menu-item>
															<div class="myButton">
																<a href="myCenter.html"><span style="color: #FFFFFF;">我的课程</span></a>
															</div>
														</el-submenu>
													</el-menu>
												</div>
											</li>
											<li id="topUser" style="float: left; margin-top:8px; width:120px; " >
												<div id="myHeadPic1" v-if="Hwg.getToken()!=''&&Hwg.getToken()!=null&&Hwg.getToken()!='null'">
													<el-menu class="el-menu-demo" mode="horizontal"  style="border-bottom: none;" active-text-color="#fff">
														<el-submenu>
															<template slot="title">
																<a href="myCenter.html"><img src="http://localhost:8010/MSLOGO.png" style="border:  solid 1px rosybrown; width: 100%;" class="myPic"></a>
															</template>
															<div style="font-size: 14px; color: #869791; text-align: center; ">“{{user.ui_truename}}” 登录中</div>
															<hr />
															<el-menu-item>
																<div class="mySetting">我的认证证书</div>
															</el-menu-item>
															<el-menu-item>
																<div class="mySetting">我的优惠券</div>
															</el-menu-item>
															<el-menu-item>
																<div class="mySetting">设置</div>
															</el-menu-item>
															<el-menu-item>
																<div class="mySetting" @click="outLogin()">退出</div>
															</el-menu-item>
														</el-submenu>
													</el-menu>
												</div>
												<div  v-else>
													<a title="点击登录"  @click="getLogin()"><img src="http://localhost:8010/MSLOGO.png" style="border:  solid 1px rosybrown; width:50%;" class="myPic"></a>
												</div>
											</li>
										</ul>
									</div>
									
								</nav>
							</div>
						</div>
					</div>
				</div>
				<!-- 窗口顶部结束 -->

			</header>
			<!-- –––––––––––––––[ 首部结束 ]––––––––––––––– -->

			<!-- –––––––––––––––[ 页面内容]––––––––––––––– -->
			<main id="mainContent" class="main-content" style="position: relative;">
				<div class="page-container ptb-10" id="courseList">
					<div class="container">
						<div class="row row-rl-10 row-tb-20">
							<div class="page-content col-xs-12 col-md-8">

								<section class="section deals-area">

									<!-- Page Control -->
									<header class="page-control panel ptb-15 prl-20 pos-r mb-30">

										<div >
											<!-- Breadcrumb 面包屑 -->
											<div>
												<span>
												<a href="index.html">首页</a>
											</span>
												<span>
												<span>></span>
												<a href="#">全部课程</a>
												</span>
												<span v-show="categoryName!=''">
													<span>></span>
													<a href="#">{{categoryName}}</a>
												</span>
											</div>
											<!-- Breadcrumb 面包屑结束 -->

											<!--课程分类-->
											<div id="menu" class="right-10" style="background: #f7f7f7; height: 200px; margin-top: 10px; padding: 5px 5px; font-size: 16px;">
												<div style="width: 90%; margin: 0 auto;">
													<ul>
														<li class="category-li">
															<a href="#" @click="getCategoryName(0)">
																<i class="el-icon-menu"></i>
																<span id="0">全部</span>
															</a>
														</li>
														<li class="category-li" v-for="(a,index) in category">
															<a href="#" @click="getCategoryName(a.navId)">
																<i class="el-icon-star-on"></i>
																<span :id="a.navId">{{a.navName}}</span>
															</a>
														</li>
														<li class="category-li">
															<a href="#">
																<el-dropdown id="dropdown" style="font-size: 16px; color:#29ad6a;">
																	<span class="el-dropdown-link">
																	<i class="el-icon-more"></i>
																	更多<i class="el-icon-arrow-down el-icon--right"></i>
																</span>
																	<el-dropdown-menu slot="dropdown">
																		<el-dropdown-item>大学先修课<i class="el-icon-arrow-right el-icon--right"></i></el-dropdown-item>
																		<el-dropdown-item>职业教育课<i class="el-icon-arrow-right el-icon--right"></i></el-dropdown-item>
																		<el-dropdown-item>教师系列MOOC<i class="el-icon-arrow-right el-icon--right"></i></el-dropdown-item>
																	</el-dropdown-menu>
																</el-dropdown>
															</a>
														</li>
													</ul>
												</div>
											</div>
											<!--课程分类结束-->
										</div>
									</header>

									<!-- 课程列表 -->
									<div class="row row-tb-20">
										<div class="col-xs-12">
											<div class="deal-single panel" >
												<div class="row row-rl-0 row-sm-cell" id="c_details" v-for="(c,index) in course" @click="getThisCourse(c.courseId)">
													<div class="col-sm-4">
														<img src="http://localhost:8010/img/deal_01.jpg" style="width: 100%;" />
													</div>
													<div class="col-sm-7" >
														<div class="pt-20 pl-20 pr-15">
															<div class="pr-md-10">
																<div class="rating mb-10">
																	<h3><a>{{c.courseName}}</a></h3>
																</div>

																<ul class="deal-meta list-inline mb-10 color-mid">
																	<!--<li>学校名称</li>-->
																	<li class="c_detail">{{c.teacher}}</li>
																</ul>
																<p class="text-muted mb-20 c_detail">{{c.courseRemark}}</p>
															</div>
															<div class="deal-price pos-r mb-15">
																<ul class="deal-meta list-inline mb-10 color-mid">
																	<li><i class="el-icon-date"></i> {{ c.number}}人参加</li>
																	<li style="color:#29ad6a;"><i class="el-icon-time"></i> 进行至第1周</li>
																</ul>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
									<!-- 课程列表结束 -->

									<!-- Page Pagination -->
									<div class="block">
									  <div> &nbsp;</div>
									    <el-pagination
									      @size-change="handleSizeChange"
									      @current-change="handleCurrentChange"
									      :current-page="currentPage4"
									      :page-sizes="[10, 20, 30, 40]"
									      :page-size="pageSize"
									      layout="total, sizes, prev, pager, next, jumper"
									      :total="total">
									    </el-pagination>
									 </div>
									<!-- End Page Pagination -->

								</section>

							</div>
							<div class="page-sidebar col-md-4 col-xs-12">

								<!-- Blog Sidebar -->
								<aside class="sidebar blog-sidebar">
									<div class="row row-tb-10">
										<div class="col-xs-12">
										<!--热门课程开始-->
											<div class="col-xs-12">
												<!-- Best Rated Deals -->
													<div class="widget best-rated-deals panel pt-20 prl-20">
														<h3 class="widget-title h-title">本周课程热度排行</h3>
														<div class="widget-body ptb-30">
															<div class="media"  v-for="(c,index) in hotCourse" v-if="index==0">
																<a @click="getThisCourse(c.courseId)">
																	<div class="media-left">
																			<img class="media-object" src="http://localhost:8010/MSLOGO1.PNG" alt="Thumb" width="80">
																	</div>
																	<div class="media-body">
																		<h6 class="mb-5">
			                   												{{c.courseName}}
			              												</h6>
																		<br />
																		<span class="color-muted">{{ c.number}}人参加</span>
																	</div>
																</a>
															</div>
															<div class="media" v-for="(c,index) in hotCourse" v-if="index>0">
																<a @click="getThisCourse(c.courseId)"><h6 style="font-weight: 500;"  class="searchSelect">{{ index+1 }}. {{c.courseName}}</h6></a>
															</div>
														</div>
													</div>
												<!-- Best Rated Deals -->
											</div>
										</div>
									</div>	
							</div>
						</div>
					</div>
				</div>
			</main>

			<!-- scrolling=no(取消iframe滚动条) onLoad事件调用iFrameHeight方法解决iframe自适应高度问题 -->
			<iframe src="buttom.html" id="iframepage" scrolling=no width="100%" onLoad="iFrameHeight()" style="margin-top: 30px; margin-bottom: -7px;"></iframe>
	</body>
	<!--顶部导航 虚拟dom（不固定）-->
	<script>
		let topMenu = new Vue({
			el: '#topMenu',
			data: {
				category: [],
				inputText: '',
		        text: '',
		        nowIndex: -1,
		        result: [],//存储查询出的数据
		        user:[]//存储用户信息
			},
			methods: {
				//获取所有分类
				getCategory: function() {
					let tis = this;
					axios.get('http://localhost:8010/category',{
						params: {
							  access_token: ''
						}
					}).then(function(response) {
						tis.category = response.data
					}).catch(function(error) {
						console.log(error);
					});
				},
				show: function(ev) {
		          if (ev.keyCode == 38 || ev.keyCode == 40) {
		            if (this.nowIndex < -1){
		              return;
		            }
		            if (this.nowIndex != this.result.length && this.nowIndex != -1) {
		              this.inputText = this.result[this.nowIndex];
		            }
		            return;
		          }
		          this.text = this.inputText;
		         axios.get('http://localhost:8010/learnrecord/getLearnrecordByStuId', {
		            params: {
		              stuId: this.inputText
		            },
		            jsonp: 'cb'
		          }).then(res => {
		            this.result = res.data;
		          })
		        },
		        down: function() {
		          this.nowIndex++;
		          if (this.nowIndex == this.result.length) {
		            this.nowIndex = -1;
		            this.inputText = this.text;
		          }
		        },
		        up: function() {
		          this.nowIndex--;
		          if (this.nowIndex < -1){
		            this.nowIndex = -1;
		            return;
		          }
		          if (this.nowIndex == -1) {
		            this.nowIndex = this.result.length;
		            this.inputText = this.text;
		          }
		        },
		        getLogin:function(){
		        	window.location.href="http://localhost:8000/yongwenzheng/login/index.html?urlpath="+location
		        },
		        outLogin:function(){
					outUser('http://127.0.0.1:8020/HWG(Frontend)/index.html');
		        }
			},
			mounted() {
				this.getCategory();
			}
		})
	</script>
	<!-- 分类菜单dom-->
	<script>
		let flag = true;
		let menu = new Vue({
			el: '#courseList',
			data: {
				category: [],
				categoryName: '',
				lastId: null,
				course: [],
				hotCourse: [],
		        currentPage4: 1,
		        total:0,
		        pageSize:10,
		        page:1,
		        cid:0

			},
			methods: {
				//获取所有分类
				getCategory: function() {//获取所有分类
					let tis = this;
					axios.get('http://localhost:8010/category',{
						params: {
							access_token: ''
						}
					}).then(function(response) {
						tis.category = response.data
					}).catch(function(error) {
						console.log(error);
					});
				},
				getCategoryName: function(i) {
					if(i == 0) {
						document.getElementById(this.lastId).parentNode.setAttribute('style', 'background-color: #f7f7f7;');
						this.categoryName = '';
						document.getElementById("0").parentNode.setAttribute('style', 'background-color: #55b929;color: #ffffff;padding: 5px 10px');
						this.lastId = i;
					} else {
						document.getElementById(this.lastId).parentNode.setAttribute('style', 'background-color: #f7f7f7;');
						this.categoryName = document.getElementById(i).innerHTML;
						document.getElementById(i).parentNode.setAttribute('style', 'background-color: #55b929;color: #ffffff;padding: 5px 10px');
						this.lastId = i;
					}
					//调用查询课程
					this.getCourse(i,1,10);
					this.cid=i;
				},
				getCourse:function(id,page,size){
					let tis = this;
					axios.get('http://localhost:8010/course/getCourseByCategoryId',{
						params: {
							access_token: '',
							cId:id
						}
					}).then(function(response) {
						tis.total=response.data.length
						tis.course = response.data.slice((page-1)*10,page*size)
					}).catch(function(error) {
						console.log(error);
					});
				},
				getThisCourse:function(i){
					window.sessionStorage.setItem("cateName",this.categoryName)
					window.sessionStorage.setItem("cataId",this.lastId)
					window.location.href="http://127.0.0.1:8020/HWG(Frontend)/courseGs.html?cid="+i
				},
				getHotCourse:function() {
					var tis = this;
					axios.get('http://localhost:8010/learnrecord/getHotCourse').then(function(response) {
						tis.hotCourse = response.data
					}).catch(function(error) {
						console.log(error);
					});
				},
				 handleSizeChange(val) {
				 this.getCourse(this.cid,this.page,val)
				 this.pageSize=val;
				 
			    },
			      handleCurrentChange(val) {
			       this.getCourse(this.cid,val,this.pageSize)
			        this.page=val;
			    }
			},
			mounted() {
				this.getCategory();
				this.getHotCourse();
			},
			updated() {
				if(flag == true) {
					document.getElementById("0").parentNode.setAttribute('style', 'background-color: #55b929;color: #ffffff;padding: 5px 10px');
					this.lastId = 0;
					//调用点击分类方法
					this.getCategoryName(Hwg.getUrlKey("kid"));
					flag = false;
				}
				

			}
		})
	</script>
	<!--js解决ifram高度自适应-->
	<script>
		function iFrameHeight() {
			var ifm = document.getElementById("iframepage");
			var subWeb = document.frames ? document.frames["iframepage"].document : ifm.contentDocument;
			if(ifm != null && subWeb != null) {
				ifm.height = subWeb.body.scrollHeight;
			}
		}
	</script>
	<style>
		.category-li {
			width: 20%;
			float: left;
			line-height: 50px;
		}
		
		#c_details {
			margin: 10px;
			cursor: pointer;
		}
		
		#c_details:hover {
			background: #f5f5f5;
		}
		
		#c_details img {
			transition: all 0.6s;
		}
		
		#c_details img:hover {
			transform: scale(1.1);
		}
		
		.c_detail:hover {
			color: #29ad6a;
		}
	</style>
</html>